<html>
<head>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
</head>
<body>  
<h1 style="text-decoration: underline;">STYLES config</h1>

<p>Background color select:
<select id="background_select">
<option value="000000" style="background-color: #000000">________</option>
<option value="555555" style="background-color: #555555">________</option>
<option value="AAAAAA" style="background-color: #AAAAAA">________</option>
<option value="FFFFFF" style="background-color: #FFFFFF">________</option>
<option value="550000" style="background-color: #550000">________</option>

<option value="FFAAAA" style="background-color: #FFAAAA">________</option>
<option value="FF5555" style="background-color: #FF5555">________</option>
<option value="FF0000" style="background-color: #FF0000">________</option>
<option value="AA5555" style="background-color: #AA5555">________</option>
<option value="AA0000" style="background-color: #AA0000">________</option>

<option value="FF55AA" style="background-color: #FF55AA">________</option>
<option value="FF00AA" style="background-color: #FF00AA">________</option>
<option value="FF0055" style="background-color: #FF0055">________</option>
<option value="AA0055" style="background-color: #AA0055">________</option>
<option value="550055" style="background-color: #550055">________</option>

<option value="FFAAFF" style="background-color: #FFAAFF">________</option>
<option value="FF55FF" style="background-color: #FF55FF">________</option>
<option value="FF00FF" style="background-color: #FF00FF">________</option>
<option value="AA00AA" style="background-color: #AA00AA">________</option>
<option value="AA55AA" style="background-color: #AA55AA">________</option>

<option value="AAAAFF" style="background-color: #AAAAFF">________</option>
<option value="AA55FF" style="background-color: #AA55FF">________</option>
<option value="AA00FF" style="background-color: #AA00FF">________</option>
<option value="5555AA" style="background-color: #5555AA">________</option>
<option value="5500AA" style="background-color: #5500AA">________</option>

<option value="0000FF" style="background-color: #0000FF">________</option>
<option value="0000AA" style="background-color: #0000AA">________</option>
<option value="000055" style="background-color: #000055">________</option>
<option value="5555FF" style="background-color: #5555FF">________</option>
<option value="5500FF" style="background-color: #5500FF">________</option>

<option value="0055FF" style="background-color: #0055FF">________</option>
<option value="0055AA" style="background-color: #0055AA">________</option>
<option value="00AAFF" style="background-color: #00AAFF">________</option>
<option value="55AAFF" style="background-color: #55AAFF">________</option>
<option value="00AAAA" style="background-color: #00AAAA">________</option>

<option value="AAFFAA" style="background-color: #AAFFAA">________</option>
<option value="AAFFFF" style="background-color: #AAFFFF">________</option>
<option value="55FFFF" style="background-color: #55FFFF">________</option>
<option value="00FFFF" style="background-color: #00FFFF">________</option>
<option value="55AAAA" style="background-color: #55AAAA">________</option>

<option value="00FFAA" style="background-color: #00FFAA">________</option>
<option value="55FFAA" style="background-color: #55FFAA">________</option>
<option value="00FF55" style="background-color: #00FF55">________</option>
<option value="005555" style="background-color: #005555">________</option>
<option value="005500" style="background-color: #005500">________</option>

<option value="55FF00" style="background-color: #55FF00">________</option>
<option value="55FF55" style="background-color: #55FF55">________</option>
<option value="AAFF55" style="background-color: #AAFF55">________</option>
<option value="AAFF00" style="background-color: #AAFF00">________</option>
<option value="555500" style="background-color: #555500">________</option>

<option value="00FF00" style="background-color: #00FF00">________</option>
<option value="55AA55" style="background-color: #55AA55">________</option>
<option value="00AA55" style="background-color: #00AA55">________</option>
<option value="00AA00" style="background-color: #00AA00">________</option>
<option value="55AA00" style="background-color: #55AA00">________</option>

<option value="FFFFAA" style="background-color: #FFFFAA">________</option>
<option value="FFFF55" style="background-color: #FFFF55">________</option>
<option value="FFFF00" style="background-color: #FFFF00">________</option>
<option value="AAAA55" style="background-color: #AAAA55">________</option>
<option value="AAAA00" style="background-color: #AAAA00">________</option>

<option value="FFAA55" style="background-color: #FFAA55">________</option>
<option value="FFAA00" style="background-color: #FFAA00">________</option>
<option value="FF5500" style="background-color: #FF5500">________</option>
<option value="AA5500" style="background-color: #AA5500">________</option>
</select>
</p>

<p>Foreground color select:
<select id="foreground_select">
<option value="000000" style="background-color: #000000">________</option>
<option value="555555" style="background-color: #555555">________</option>
<option value="AAAAAA" style="background-color: #AAAAAA">________</option>
<option value="FFFFFF" style="background-color: #FFFFFF">________</option>
<option value="550000" style="background-color: #550000">________</option>

<option value="FFAAAA" style="background-color: #FFAAAA">________</option>
<option value="FF5555" style="background-color: #FF5555">________</option>
<option value="FF0000" style="background-color: #FF0000">________</option>
<option value="AA5555" style="background-color: #AA5555">________</option>
<option value="AA0000" style="background-color: #AA0000">________</option>

<option value="FF55AA" style="background-color: #FF55AA">________</option>
<option value="FF00AA" style="background-color: #FF00AA">________</option>
<option value="FF0055" style="background-color: #FF0055">________</option>
<option value="AA0055" style="background-color: #AA0055">________</option>
<option value="550055" style="background-color: #550055">________</option>

<option value="FFAAFF" style="background-color: #FFAAFF">________</option>
<option value="FF55FF" style="background-color: #FF55FF">________</option>
<option value="FF00FF" style="background-color: #FF00FF">________</option>
<option value="AA00AA" style="background-color: #AA00AA">________</option>
<option value="AA55AA" style="background-color: #AA55AA">________</option>

<option value="AAAAFF" style="background-color: #AAAAFF">________</option>
<option value="AA55FF" style="background-color: #AA55FF">________</option>
<option value="AA00FF" style="background-color: #AA00FF">________</option>
<option value="5555AA" style="background-color: #5555AA">________</option>
<option value="5500AA" style="background-color: #5500AA">________</option>

<option value="0000FF" style="background-color: #0000FF">________</option>
<option value="0000AA" style="background-color: #0000AA">________</option>
<option value="000055" style="background-color: #000055">________</option>
<option value="5555FF" style="background-color: #5555FF">________</option>
<option value="5500FF" style="background-color: #5500FF">________</option>

<option value="0055FF" style="background-color: #0055FF">________</option>
<option value="0055AA" style="background-color: #0055AA">________</option>
<option value="00AAFF" style="background-color: #00AAFF">________</option>
<option value="55AAFF" style="background-color: #55AAFF">________</option>
<option value="00AAAA" style="background-color: #00AAAA">________</option>

<option value="AAFFAA" style="background-color: #AAFFAA">________</option>
<option value="AAFFFF" style="background-color: #AAFFFF">________</option>
<option value="55FFFF" style="background-color: #55FFFF">________</option>
<option value="00FFFF" style="background-color: #00FFFF">________</option>
<option value="55AAAA" style="background-color: #55AAAA">________</option>

<option value="00FFAA" style="background-color: #00FFAA">________</option>
<option value="55FFAA" style="background-color: #55FFAA">________</option>
<option value="00FF55" style="background-color: #00FF55">________</option>
<option value="005555" style="background-color: #005555">________</option>
<option value="005500" style="background-color: #005500">________</option>

<option value="55FF00" style="background-color: #55FF00">________</option>
<option value="55FF55" style="background-color: #55FF55">________</option>
<option value="AAFF55" style="background-color: #AAFF55">________</option>
<option value="AAFF00" style="background-color: #AAFF00">________</option>
<option value="555500" style="background-color: #555500">________</option>

<option value="00FF00" style="background-color: #00FF00">________</option>
<option value="55AA55" style="background-color: #55AA55">________</option>
<option value="00AA55" style="background-color: #00AA55">________</option>
<option value="00AA00" style="background-color: #00AA00">________</option>
<option value="55AA00" style="background-color: #55AA00">________</option>

<option value="FFFFAA" style="background-color: #FFFFAA">________</option>
<option value="FFFF55" style="background-color: #FFFF55">________</option>
<option value="FFFF00" style="background-color: #FFFF00">________</option>
<option value="AAAA55" style="background-color: #AAAA55">________</option>
<option value="AAAA00" style="background-color: #AAAA00">________</option>

<option value="FFAA55" style="background-color: #FFAA55">________</option>
<option value="FFAA00" style="background-color: #FFAA00">________</option>
<option value="FF5500" style="background-color: #FF5500">________</option>
<option value="AA5500" style="background-color: #AA5500">________</option>
</select>
</p>

<p>Temperature select:
<select id="temp_select">
<option value="F">F</option>
<option value="C">C</option>
</select>
</p>

<p>Weather source:
<select id="weatherSource">
<option>GPS</option>
<option>No GPS</option>
</select>
</p>

<div class="noGPSclass">
<p>ZIP code for weather
<input type = "text" id="zip" >
<button type = "button" id="zip_button">Submit</button>  

<p id="latitude">Latitude:</p>
<p id="longitude">Longitude:</p>
</div>
  
<p>Custom text to display:
<input type = "text" id = "customText" value = "" maxlength="13">
</p>

<p>
Please make a donation if you can for...<br>
- New developments and support.<br>
- Help fund a pebble time for myself<br> 
(better apps and smartstrap development) <br>
Thanks! 
<p>
<img src="https://www.paypalobjects.com/webstatic/en_US/i/buttons/pp-acceptance-small.png" alt="Buy now with PayPal" />
<a href="https://www.paypal.me/JJH4">-=DONATE=-</a> 
<img src="https://www.paypalobjects.com/webstatic/en_US/i/buttons/pp-acceptance-small.png" alt="Buy now with PayPal" />

<p> <button id="save_button">Save</button> </p>

<script>
var sLatitude = "";
var sLongitude = "";
var tempSelect = document.getElementById("temp_select");
var isGPS = document.getElementById("weatherSource");
var latitude = document.getElementById('latitude');
var longitude = document.getElementById('longitude');
var zip = document.getElementById('zip');
var userText = document.getElementById("customText");
var foreground_select = document.getElementById("foreground_select");
var background_select = document.getElementById("background_select");
  
$(".noGPSclass").hide();
$(document).ready(function(){
  // Load any previously saved configuration, if available
    if(localStorage['tempUnits']) {
	
	  tempSelect.value = localStorage['tempUnits'];
      isGPS.value = localStorage['isGPS'];
      latitude.innerHTML = localStorage['latitude'];
      longitude.innerHTML = localStorage['longitude'];
      zip.value = localStorage['zip'];
	  userText.value = localStorage['userText'];
	  foreground_select.value = localStorage['foreground'];
	  background_select.value = localStorage['background'];
	  
	  if ($('#weatherSource>option:selected').text() === "No GPS"){
		 $(".noGPSclass").fadeIn();
	  }
    }
	else{
		background_select.value = "000000";
		foreground_select.value = "FFFFFF";
	}
	
	background_select.style.backgroundColor = background_select.value;
	foreground_select.style.backgroundColor = foreground_select.value;
})
  //----------------------------------------
  $("#zip_button").click(function(){
    //console.log("zip button clicked");
    var geocoder = new google.maps.Geocoder();
    geocoder.geocode( { 'address': $('#zip').val()}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
	 sLatitude = results[0].geometry.location.lat();
	 sLongitude = results[0].geometry.location.lng();
	 $("#latitude").text(sLatitude);
	 $("#longitude").text(sLongitude);
      } else {
	$("#latitude").text("Latitude: ERROR");
	$("#longitude").text("Longitude: ERROR");
      }
    });
  });
  
  $("#foreground_select").change(function(){
	foreground_select.style.backgroundColor = foreground_select.value;
  })
  
    $("#background_select").change(function(){
	background_select.style.backgroundColor = background_select.value;
  })
  
  $("#weatherSource").change(function(){
    console.log("weather source changed to " + $('#weatherSource>option:selected').text());
    if ($('#weatherSource>option:selected').text() === "No GPS") {
      $(".noGPSclass").fadeIn();
    }
    else
    {
      $(".noGPSclass").fadeOut();
    }
   
  })
  
  var options = {
      "tempUnits": 0,
      "isGPS": 0,
      "latitude": "",
      "longitude": "",
      "userText": ""
    };
  
  //Setup to allow easy adding more options later
  function saveOptions() {
    options = {
      "tempUnits": tempSelect.options[tempSelect.selectedIndex].value,
      "isGPS": isGPS.options[isGPS.selectedIndex].value,
      "latitude": latitude.innerHTML,
      "longitude": longitude.innerHTML,
      "userText": userText.value
    }
	
	// Save for next launch
    localStorage['tempUnits'] = options['tempUnits'];
	localStorage['isGPS'] = options['isGPS'];
    localStorage['latitude'] = options['latitude'];
	localStorage['longitude'] = options['longitude'];
    localStorage['zip'] = zip.value;
	localStorage['userText'] = options['userText'];
	localStorage['foreground'] = foreground_select.value;
	localStorage['background'] = background_select.value;
	
	//console.log("userText = %s",userText.value);
    return options;
  };
  
  function getQueryParam(variable, defaultValue) {
    var query = location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split('=');
      if (pair[0] === variable) {
        return decodeURIComponent(pair[1]);
      }
    }
    return defaultValue || false;
  }
 //------------------------------------------------		
  var submitButton = document.getElementById("save_button");
  submitButton.addEventListener("click", 
    function() {
      console.log("Submit");
 
      options.get = saveOptions();
	  
	  // Set the return URL depending on the runtime environment
      var return_to = getQueryParam('return_to', 'pebblejs://close#');
      document.location = return_to + encodeURIComponent(JSON.stringify(options)); 
    });
  
</script>
</body>
</html>

